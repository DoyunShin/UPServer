function onload(){document.title="Doyun's Upload",dropenable();var e=window.location.hostname,n="https:"==window.location.protocol,o=window.location.port,t="curl --upload-file hello.txt "+(n?"https://":"http://")+e+(o?":"+o:"")+"/hello.txt";window.uploadcmd=t,document.getElementById("status").innerHTML="> "+t}const sleep=e=>new Promise((n=>setTimeout(n,e)));function changeicon(e){var n=document.getElementById("urlcopy"),o={urlcopyicon:"btn-primary",urlcopysuccessicon:"btn-success",urlcopyerroricon:"btn-danger",urlcopyspinicon:"btn-dark"};if(0!=o.hasOwnProperty(e)){n.disabled="urlcopyicon"!=e;for(var t=Object.keys(o),r=0;r<t.length;r++){var d=document.getElementById(t[r]);t[r]==e?(d.removeAttribute("hidden"),n.className="btn "+o[e]+" btn-sm"):d.setAttribute("hidden","")}}}function openfile(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("id","file"),e.setAttribute("name","file"),e.setAttribute("style","display:none"),e.addEventListener("change",(function(){upload(e.files[0])}),!1),e.click()}function dropenable(){var e=document.getElementById("drag-n-drop");e.addEventListener("dragleave",dragleave,!1),e.addEventListener("dragover",dragover,!1),e.addEventListener("drop",drop,!1)}function dropdisable(){var e=document.getElementById("drag-n-drop");e.removeEventListener("dragleave",dragleave,!1),e.removeEventListener("dragover",dragover,!1),e.removeEventListener("drop",drop,!1)}async function upload(e){dropdisable();var n=document.getElementById("status"),o=new XMLHttpRequest,t=e.name;for(window.uprogress=0,o.open("PUT","http://127.0.0.1:8080/"+t,!0),o.upload.onprogress=function(e){window.uprogress=Math.round(e.loaded/e.total*100)},o.send(e),changeicon("urlcopyspin"),window.nowuploading=!0;4!=o.readyState;){if(4==o.readyState)return;n.innerHTML="Uploading "+t+"  ("+window.uprogress+"%)...",await sleep(100)}if(window.nowuploading=!1,200==o.status){rtn=o.responseText,console.log(rtn);var r=document.createElement("a");r.href=rtn,r.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;"+rtn,n.innerHTML="",n.appendChild(r),changeicon("urlcopysuccessicon"),dropenable(),await sleep(1e3),changeicon("urlcopyicon")}else n.innerHTML="Error uploading "+t+".",changeicon("urlcopyerroricon"),dropenable(),await sleep(5e3),0==window.nowuploading&&(n.innerHTML="> curl --upload-file hello.txt https://upload.doyun.me/hello.txt",changeicon("urlcopyicon"))}async function copy(){var e=document.getElementById("status").firstChild.href;if(void 0===e&&(e=window.uploadcmd),navigator.clipboard)await navigator.clipboard.writeText(e);else{console.log("Function navigator.clipboard not supported. Using textArea instead.");var n=document.createElement("input");n.value=e,n.style.display="none",document.body.appendChild(n),n.focus(),n.setSelectionRange(0,n.value.length),document.execCommand("copy"),document.body.removeChild(n)}changeicon("urlcopysuccessicon"),await sleep(2e3),changeicon("urlcopyicon")}function dragenter(e){e.stopPropagation(),e.preventDefault();var n=document.getElementById("drag-n-drop");n.style.backgroundColor="#A09BBD",n.style.border="1px solid #FFFFFF",n.style.borderStyle="dashed"}function dragleave(e){e.stopPropagation(),e.preventDefault();var n=document.getElementById("drag-n-drop");n.style.backgroundColor="#4E4C5C",n.style.border="0px solid #FFFFFF",n.style.borderStyle="none"}function dragover(e){e.stopPropagation(),e.preventDefault();var n=document.getElementById("drag-n-drop");n.style.backgroundColor="#A09BBD",n.style.border="1px solid #FFFFFF",n.style.borderStyle="dashed"}function drop(e){e.stopPropagation(),e.preventDefault();var n=document.getElementById("drag-n-drop");n.style.backgroundColor="#4E4C5C",n.style.border="0px solid #FFFFFF",upload(e.dataTransfer.files[0])}window.addEventListener("load",onload,!1);